/*
* https://github.com/justspamjustin/BossView
* BossView v 0.1.0
*/
Backbone.Marionette.BossView=Backbone.Marionette.ItemView.extend({template:function(){return""},constructor:function(){Backbone.Marionette.ItemView.prototype.constructor.apply(this,arguments);this.initializeSubViews();this.initializeChildViewEvents();this.initializeSubViewEventBubbling();this.listenTo(this,"render",this.onParentRendered)},getParentEl:function(){return this.$el},initializeSubViews:function(){this.eachSubView(_.bind(function(e,t){var n;var r=_.isFunction(t.prototype.render);if(r){n=new t({model:this.model,collection:this.collection})}else{n=t.call(this)}if(_.isUndefined(n)||!_.isFunction(n.render)){throw new Error("The subview named "+e+" does not have a render function.")}this[e]=n},this))},initializeChildViewEvents:function(){this.eachSubViewEvent(_.bind(function(e,t,n){if(_.isString(n)){if(_.isUndefined(this[n])){throw new Error("This view has no function named "+n+" to use as a callback for the event "+t)}n=this[n]}if(e==="*"){this.eachSubView(_.bind(function(e){var r=this[e];this.listenTo(r,t,n)},this))}else{this.listenTo(e,t,n)}},this))},onParentRendered:function(){this.renderSubViews()},renderSubViews:function(){this.eachSubView(_.bind(function(e){var t=this.getParentEl();if(this.hasSubViewContainer(e)){t=this.getSubViewContainer(e)}else if(this.getMainSubViewContainer()){t=this.$(this.getMainSubViewContainer())}this.renderSubView(e,t)},this))},renderSubView:function(e,t){if(this.shouldRenderSubView(e)){this[e].render().$el.appendTo(t);this[e].delegateEvents()}},shouldRenderSubView:function(e){var t=this.getSubViewRenderConditions()[e];var n=_.isFunction(t);return n?t.call(this):true},eachSubView:function(e){if(this.getSubViews()){for(var t in this.getSubViews()){e(t,this.getSubViews()[t])}}},eachSubViewEvent:function(e){if(this.getSubViewEvents()){for(var t in this.getSubViewEvents()){var n=t.split(" ");var r=n[0];var i=n[1];if(r!=="*"&&_.isUndefined(this[r])){throw new Error("Subview named "+r+" is not defined in subViews.")}var s=r==="*"?"*":this[r];e(s,i,this.getSubViewEvents()[t])}}},hasSubViewContainer:function(e){return!_.isUndefined(this.getSubViewContainers())&&!_.isUndefined(this.getSubViewContainers()[e])},getSubViewContainer:function(e){if(!this.hasSubViewContainer(e)){throw new Error("No subview container for subView: "+e)}return this.$(this.getSubViewContainers()[e])},getSubViewContainers:function(){return this.subViewContainers||this.options.subViewContainers},getMainSubViewContainer:function(){return this.mainSubViewContainer||this.options.mainSubViewContainer},getSubViews:function(){var e=this.callFunctionIfFunction(this.subViews);if(this.options.subViews){e=this.callFunctionIfFunction(this.options.subViews)}return e},getSubViewEvents:function(){return this.subViewEvents||this.options.subViewEvents},getSubViewRenderConditions:function(){return this.subViewRenderConditions||this.options.subViewRenderConditions||{}},remove:function(){Backbone.Marionette.ItemView.prototype.remove.apply(this,arguments);this.removeSubViews()},removeSubViews:function(){this.eachSubView(_.bind(function(e){this[e].remove()},this))},callFunctionIfFunction:function(e){var t=e;if(_.isFunction(e)){t=e.call(this)}return t},initializeSubViewEventBubbling:function(){this.eachSubView(_.bind(function(e){var t=this[e];this.listenTo(t,"all",function(){this.trigger(e+":"+arguments[0],arguments[1])})},this))}})