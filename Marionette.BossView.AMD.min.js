/*
* https://github.com/justspamjustin/BossView
* BossView v 0.1.1
*/
define(function(e){"use strict";var t=e("underscore");var n=e("marionette");n.BossView=n.ItemView.extend({template:function(){return""},constructor:function(){n.ItemView.prototype.constructor.apply(this,arguments);this.initializeSubViews();this.initializeChildViewEvents();this.initializeSubViewEventBubbling();this.listenTo(this,"render",this.onParentRendered)},getParentEl:function(){return this.$el},initializeSubViews:function(){this.eachSubView(t.bind(function(e,n){var r;var i=t.isFunction(n.prototype.render);if(i){r=new n({model:this.model,collection:this.collection})}else{r=n.call(this)}if(t.isUndefined(r)||!t.isFunction(r.render)){throw new Error("The subview named "+e+" does not have a render function.")}this[e]=r},this))},initializeChildViewEvents:function(){this.eachSubViewEvent(t.bind(function(e,n,r){if(t.isString(r)){if(t.isUndefined(this[r])){throw new Error("This view has no function named "+r+" to use as a callback for the event "+n)}r=this[r]}if(e==="*"){this.eachSubView(t.bind(function(e){var t=this[e];this.listenTo(t,n,r)},this))}else{this.listenTo(e,n,r)}},this))},onParentRendered:function(){this.renderSubViews()},renderSubViews:function(){this.eachSubView(t.bind(function(e){var t=this.getParentEl();if(this.hasSubViewContainer(e)){t=this.getSubViewContainer(e)}else if(this.getMainSubViewContainer()){t=this.$(this.getMainSubViewContainer())}this.renderSubView(e,t)},this))},renderSubView:function(e,t){if(this.shouldRenderSubView(e)){this[e].render().$el.appendTo(t);this[e].delegateEvents()}},shouldRenderSubView:function(e){var n=this.getSubViewRenderConditions()[e];var r=t.isFunction(n);return r?n.call(this):true},eachSubView:function(e){if(this.getSubViews()){for(var t in this.getSubViews()){e(t,this.getSubViews()[t])}}},eachSubViewEvent:function(e){if(this.getSubViewEvents()){for(var n in this.getSubViewEvents()){var r=n.split(" ");var i=r[0];var s=r[1];if(i!=="*"&&t.isUndefined(this[i])){throw new Error("Subview named "+i+" is not defined in subViews.")}var o=i==="*"?"*":this[i];e(o,s,this.getSubViewEvents()[n])}}},hasSubViewContainer:function(e){return!t.isUndefined(this.getSubViewContainers())&&!t.isUndefined(this.getSubViewContainers()[e])},getSubViewContainer:function(e){if(!this.hasSubViewContainer(e)){throw new Error("No subview container for subView: "+e)}return this.$(this.getSubViewContainers()[e])},getSubViewContainers:function(){return this.subViewContainers||this.options.subViewContainers},getMainSubViewContainer:function(){return this.mainSubViewContainer||this.options.mainSubViewContainer},getSubViews:function(){var e=this.callFunctionIfFunction(this.subViews);if(this.options.subViews){e=this.callFunctionIfFunction(this.options.subViews)}return e},getSubViewEvents:function(){return this.subViewEvents||this.options.subViewEvents},getSubViewRenderConditions:function(){return this.subViewRenderConditions||this.options.subViewRenderConditions||{}},remove:function(){n.ItemView.prototype.remove.apply(this,arguments);this.removeSubViews()},removeSubViews:function(){this.eachSubView(t.bind(function(e){this[e].remove()},this))},callFunctionIfFunction:function(e){var n=e;if(t.isFunction(e)){n=e.call(this)}return n},initializeSubViewEventBubbling:function(){this.eachSubView(t.bind(function(e){var t=this[e];this.listenTo(t,"all",function(){this.trigger(e+":"+arguments[0],arguments[1])})},this))}});return n.BossView})